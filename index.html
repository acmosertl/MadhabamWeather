<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ</title>
<style>
  body {
    font-family: "Noto Sans Bengali", sans-serif;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    margin: 0;
    background: linear-gradient(to bottom, #0b152b 0%, #1e2940 100%);
    color: #fff;
    transition: background 1s ease;
  }

  .weather-card {
    background: rgba(255, 255, 255, 0.12);
    padding: 20px 16px;
    border-radius: 18px;
    width: 90%;
    max-width: 300px;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.45);
    overflow: hidden;
  }

  h1 {
    font-size: 1.3em;
    margin: 5px 0 10px 0;
  }

  .location {
    font-size: 1.05em;
    opacity: 0.9;
    margin-bottom: 5px;
  }

  .temperature {
    font-size: clamp(2.6em, 6vw, 3.5em);
    font-weight: bold;
    margin: 8px 0;
  }

  .weather-icon {
    font-size: 3.2em;
    margin: 6px 0;
    text-shadow: 0 0 14px rgba(255, 215, 100, 0.9);
  }

  .condition-now {
    font-size: 1.25em;
    margin-top: 8px;
    line-height: 1.6em;
    white-space: pre-line;
    color: #fff;
    text-shadow: 0 0 6px rgba(255,255,255,0.6);
  }

  .details {
    font-size: 1.05em;
    margin-top: 6px;
    opacity: 0.95;
  }

  .forecast {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 18px;
  }

  .day {
    background: rgba(255,255,255,0.12);
    border-radius: 10px;
    padding: 8px 5px;
    text-align: center;
    font-size: 1em;
    font-weight: 500;
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  }

  .day-icon {
    font-size: 2.2em;
    margin-bottom: 3px;
    text-shadow: 0 0 8px rgba(255,215,100,0.7);
  }

  .day-temp {
    font-size: 1em;
    margin-top: 3px;
  }
</style>
</head>
<body>
  <div class="weather-card" id="weather">
    <h1>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ</h1>
    <div class="location" id="location">‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶® ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
    <div class="temperature" id="temp">--¬∞C</div>
    <div class="weather-icon" id="icon">‚òÄÔ∏è</div>
    <div class="condition-now" id="condition">‡¶è‡¶ñ‡¶®
‡¶Ü‡¶ï‡¶æ‡¶∂ ‡¶™‡¶∞‡¶ø‡¶∏‡ßç‡¶ï‡¶æ‡¶∞</div>
    <div class="details" id="details">‡¶Ü‡¶∞‡ßç‡¶¶‡ßç‡¶∞‡¶§‡¶æ: --% ‚Ä¢ ‡¶¨‡¶æ‡¶§‡¶æ‡¶∏: -- km/h ‚Ä¢ ‡¶¨‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø: -- mm</div>
    <div class="forecast" id="forecast"></div>
  </div>

<script>
function setDynamicBackground(code) {
  const body = document.body;
  const hour = new Date().getHours();
  let bg = '';

  const isNight = (hour >= 18 || hour < 6);

  if (isNight) {
    // üåô Night themes
    if ([0,1,2].includes(code)) {
      bg = 'linear-gradient(to bottom, #0b132b 0%, #1c2541 100%)';
    } else if ([3,45,48].includes(code)) {
      bg = 'linear-gradient(to bottom, #202938 0%, #3a506b 100%)';
    } else if ([51,61].includes(code)) {
      bg = 'linear-gradient(to bottom, #1a1a2e 0%, #16213e 100%)';
    } else if ([95].includes(code)) {
      bg = 'linear-gradient(to bottom, #000000 0%, #1a1a1a 100%)';
    } else {
      bg = 'linear-gradient(to bottom, #0b152b 0%, #1e2940 100%)';
    }
  } else {
    // ‚òÄÔ∏è Day themes
    if ([0,1,2].includes(code)) {
      bg = 'linear-gradient(to bottom, #1e3a8a 0%, #60a5fa 100%)';
    } else if ([3,45,48].includes(code)) {
      bg = 'linear-gradient(to bottom, #334155 0%, #64748b 100%)';
    } else if ([51,61].includes(code)) {
      bg = 'linear-gradient(to bottom, #2c3e50 0%, #4b6584 100%)';
    } else if ([95].includes(code)) {
      bg = 'linear-gradient(to bottom, #1e293b 0%, #0f172a 100%)';
    } else {
      bg = 'linear-gradient(to bottom, #1d4ed8 0%, #93c5fd 100%)';
    }
  }
  body.style.background = bg;
}

async function loadWeather(lat, lon) {
  const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=temperature_2m_max,temperature_2m_min,precipitation_sum,weathercode&current_weather=true&timezone=auto`);
  const data = await response.json();

  const temp = data.current_weather.temperature;
  const wind = data.current_weather.windspeed;
  const weatherCode = data.current_weather.weathercode;
  const humidity = data.hourly ? data.hourly.relativehumidity_2m[0] : 90;
  const conditionText = getCondition(weatherCode);
  const icon = getIcon(weatherCode);

  document.getElementById('temp').textContent = `${temp.toFixed(1)}¬∞C`;
  document.getElementById('condition').textContent = `‡¶è‡¶ñ‡¶®\n${conditionText}`;
  document.getElementById('icon').textContent = icon;
  document.getElementById('details').textContent = `‡¶Ü‡¶∞‡ßç‡¶¶‡ßç‡¶∞‡¶§‡¶æ: ${humidity}% ‚Ä¢ ‡¶¨‡¶æ‡¶§‡¶æ‡¶∏: ${wind} km/h ‚Ä¢ ‡¶¨‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø: ${data.daily.precipitation_sum[0]} mm`;

  setDynamicBackground(weatherCode);

  // ‚úÖ ‡¶∂‡ßÅ‡¶ß‡ßÅ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡¶è‡¶á ‡¶Ö‡¶Ç‡¶∂‡¶ü‡¶æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá
  let forecastHTML = '';
  const weekdays = ['‡¶∞‡¶¨‡¶ø', '‡¶∏‡ßã‡¶Æ', '‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤', '‡¶¨‡ßÅ‡¶ß', '‡¶¨‡ßÉ‡¶π‡¶∏‡ßç‡¶™‡¶§‡¶ø', '‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞', '‡¶∂‡¶®‡¶ø'];
  const todayIndex = new Date().getDay(); // ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¶‡¶ø‡¶® ‡¶á‡¶®‡¶°‡ßá‡¶ï‡ßç‡¶∏
  
  for (let i = 0; i < 7; i++) {
    const dayIndex = (todayIndex + i) % 7;
    const dayLabel = i === 0 ? '‡¶Ü‡¶ú' : weekdays[dayIndex]; // ‡¶Ü‡¶ú ‡¶∂‡ßÅ‡¶ß‡ßÅ ‚Äú‡¶Ü‡¶ú‚Äù ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá

    const max = data.daily.temperature_2m_max[i].toFixed(1);
    const min = data.daily.temperature_2m_min[i].toFixed(1);
    const code = data.daily.weathercode[i];

    forecastHTML += `
      <div class="day">
        <div class="day-icon">${getIcon(code)}</div>
        <div class="day-name">${dayLabel}</div>
        <div class="day-temp">${max}¬∞ / ${min}¬∞</div>
      </div>`;
  }

  document.getElementById('forecast').innerHTML = forecastHTML;
}

function getCondition(code) {
  const map = {
    0: '‡¶Ü‡¶ï‡¶æ‡¶∂ ‡¶™‡¶∞‡¶ø‡¶∏‡ßç‡¶ï‡¶æ‡¶∞', 1: '‡¶Æ‡ßá‡¶ò‡¶≤‡¶æ', 2: '‡¶Ü‡¶Ç‡¶∂‡¶ø‡¶ï ‡¶Æ‡ßá‡¶ò‡¶≤‡¶æ', 3: '‡¶ò‡¶® ‡¶Æ‡ßá‡¶ò',
    45: '‡¶ï‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∂‡¶æ', 48: '‡¶ò‡¶® ‡¶ï‡ßÅ‡¶Ø‡¶º‡¶æ‡¶∂‡¶æ', 51: '‡¶π‡¶æ‡¶≤‡¶ï‡¶æ ‡¶¨‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø', 61: '‡¶¨‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø',
    71: '‡¶§‡ßÅ‡¶∑‡¶æ‡¶∞‡¶™‡¶æ‡¶§', 95: '‡¶¨‡¶ú‡ßç‡¶∞‡¶∏‡¶π ‡¶¨‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø'
  };
  return map[code] || '‡¶Ü‡¶¨‡¶π‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶§‡¶•‡ßç‡¶Ø';
}

function getIcon(code) {
  const map = {
    0: '‚òÄÔ∏è', 1: 'üå§Ô∏è', 2: '‚õÖ', 3: '‚òÅÔ∏è',
    45: 'üå´Ô∏è', 48: 'üå´Ô∏è', 51: 'üå¶Ô∏è', 61: 'üåßÔ∏è',
    71: '‚ùÑÔ∏è', 95: '‚õàÔ∏è'
  };
  return map[code] || 'üå§Ô∏è';
}

if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(
    pos => {
      const lat = pos.coords.latitude;
      const lon = pos.coords.longitude;
      fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=bn`)
        .then(res => res.json())
        .then(loc => {
          document.getElementById('location').textContent = loc.city || loc.locality || '‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ';
        });
      loadWeather(lat, lon);
    },
    err => {
      document.getElementById('location').textContent = 'Kolkata';
      loadWeather(22.5726, 88.3639);
    }
  );
} else {
  document.getElementById('location').textContent = 'Kolkata';
  loadWeather(22.5726, 88.3639);
}
</script>
</body>
</html>
